<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Dali Nadjib AI Voiture â€” ØªØ´Ø®ÙŠØµ OBD Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</title>
<style>
:root{
  --bg:#05060a; --card-grad:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  --muted:#9aa4b2; --accent1:#ff6b6b; --accent2:#7c5cff; --accent3:#00d4ff; --glass:rgba(255,255,255,0.03); --radius:14px;
}
*{box-sizing:border-box;font-family: "Segoe UI", Roboto, "Noto Sans", Arial, sans-serif;}
body{ margin:0; min-height:100vh; background:
  radial-gradient(900px 400px at 8% 10%, rgba(124,92,255,0.08), transparent 6%),
  radial-gradient(700px 300px at 92% 90%, rgba(0,212,255,0.03), transparent 6%),
  var(--bg); color:#eaf4ff; padding:22px;}
.container{ max-width:1200px; margin:0 auto; display:grid; grid-template-columns:380px 1fr; gap:18px; align-items:start;}
.card{ background:var(--card-grad); border:1px solid rgba(255,255,255,0.04); padding:16px; border-radius:var(--radius); box-shadow:0 10px 30px rgba(2,6,23,0.6);}
.header{ display:flex; gap:12px; align-items:center; margin-bottom:8px;}
.appBadge{ background:linear-gradient(90deg,var(--accent2),var(--accent3)); color:#020617; padding:8px 12px; border-radius:12px; font-weight:800;}
.title{ font-size:18px; font-weight:800;}
.lead{ color:var(--muted); font-size:13px; margin:6px 0 12px 0;}
label{ display:block; color:var(--muted); font-size:13px; margin:10px 0 6px 0;}
input[type="text"], select, textarea { width:100%; padding:10px 12px; border-radius:10px; border:1px solid rgba(255,255,255,0.04); background:var(--glass); color:inherit; outline:none; font-size:14px;}
textarea{ min-height:90px; resize:vertical;}
.row{ display:flex; gap:8px;}
.btn{ padding:10px 12px; border-radius:10px; border:none; cursor:pointer; font-weight:800;}
.btn-primary{ background:linear-gradient(90deg,var(--accent2),var(--accent1)); color:#04040a;}
.btn-ghost{ background:transparent; border:1px solid rgba(255,255,255,0.04); color:var(--muted);}
.small{ font-size:12px; color:var(--muted); margin-top:8px;}
.avatar{ width:72px; height:72px; border-radius:12px; overflow:hidden; display:flex; align-items:center; justify-content:center; background:rgba(255,255,255,0.02); border:1px solid rgba(255,255,255,0.04); font-weight:800; color:var(--muted);}
.outputs{ display:flex; flex-direction:column; gap:12px;}
.resHead{ display:flex; justify-content:space-between; align-items:center; gap:10px;}
.badge{ padding:8px 12px; border-radius:999px; background:linear-gradient(90deg,var(--accent3),var(--accent2)); color:#071122; font-weight:900;}
.meta{ color:var(--muted); font-size:13px;}
.resultCard{ padding:14px; border-radius:12px; background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005)); border:1px solid rgba(255,255,255,0.02);}
.fault{ border-radius:10px; padding:12px; margin-bottom:10px; background: linear-gradient(90deg, rgba(124,92,255,0.04), rgba(0,212,255,0.02)); border:1px solid rgba(124,92,255,0.06);}
.analysis{ background:rgba(0,0,0,0.16); padding:12px; border-radius:10px; color:#dfeeff;}
.modal-overlay{ position:fixed; inset:0; background:rgba(0,0,0,0.6); display:flex; align-items:center; justify-content:center; z-index:9999;}
.modal{ width:800px; max-width:96%; max-height:80vh; overflow:auto; background:linear-gradient(180deg,#07101a,#071018); padding:12px; border-radius:10px; border:1px solid rgba(255,255,255,0.04); }
.list-row{ padding:10px; border-bottom:1px solid rgba(255,255,255,0.02); cursor:pointer;}
.empty{ text-align:center; color:var(--muted); padding:18px; border-radius:10px; border:1px dashed rgba(255,255,255,0.03);}
.footer-note{ text-align:center; color:var(--muted); margin-top:12px; font-size:13px;}
@media(max-width:980px){ .container{ grid-template-columns:1fr; padding:10px; } }
</style>
</head>
<body>
  <div class="container">
    <!-- LEFT: FORM -->
    <aside class="card" aria-labelledby="appTitle">
      <div class="header">
        <div class="avatar" id="avatarBox">D N</div>
        <div>
          <div class="appBadge">Dali Nadjib AI</div>
          <div class="title" id="appTitle">ØªØ´Ø®ÙŠØµ Ø£Ø¹Ø·Ø§Ù„ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª (OBD)</div>
          <div class="lead">ÙƒÙ„ Ø´ÙŠØ¡ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© â€” Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³ÙŠØ§Ø±Ø© ÙˆØ§Ù„ÙƒÙˆØ¯ Ø£Ùˆ Ø§Ø®ØªØ± Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©.</div>
        </div>
      </div>

      <label>Ø±ÙØ¹ ØµÙˆØ±Ø© Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</label>
      <input type="file" id="avatarFile" accept="image/*" />
      <div class="small">Ø³ØªØªØ­ÙˆÙ‘Ù„ Ø§Ù„ØµÙˆØ±Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙˆØªØ¹Ø±Ø¶ ÙƒØ¨Ø±ÙˆÙØ§ÙŠÙ„ (Ù…Ø­Ù„ÙŠÙ‹Ø§ ÙÙ‚Ø·).</div>

      <label for="brand">Ù†ÙˆØ¹ Ø§Ù„Ø³ÙŠØ§Ø±Ø© / Ø§Ù„Ù…Ø§Ø±ÙƒØ©</label>
      <select id="brand">
        <option value="all">Ø¹Ø§Ù… â€” ØºÙŠØ± Ù…Ø­Ø¯Ø¯</option>
        <option value="Renault">Renault</option>
        <option value="Peugeot">Peugeot</option>
        <option value="Chery">Chery</option>
        <option value="Fiat">Fiat</option>
        <option value="Hyundai">Hyundai</option>
        <option value="Volkswagen">Volkswagen</option>
        <option value="BMW">BMW</option>
        <option value="Other">Ù…Ø§Ø±ÙƒØ§Øª Ø£Ø®Ø±Ù‰</option>
      </select>

      <label for="model">Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„</label>
      <select id="model"></select>

      <label for="year">Ø³Ù†Ø© Ø§Ù„ØµÙ†Ø¹</label>
      <input id="year" type="text" placeholder="Ù…Ø«Ø§Ù„: 2017" />

      <label for="system">Ø§Ø®ØªØ± Ù†Ø¸Ø§Ù…/ÙØ¦Ø© Ø§Ù„Ø£ÙƒÙˆØ§Ø¯</label>
      <select id="system">
        <option value="all">ÙƒÙ„ Ø§Ù„Ø£Ù†Ø¸Ù…Ø©</option>
        <option value="engine">Ø§Ù„Ù…Ø­Ø±Ùƒ</option>
        <option value="fuel">Ù†Ø¸Ø§Ù… Ø§Ù„ÙˆÙ‚ÙˆØ¯</option>
        <option value="ignition">Ø§Ù„Ø¥Ø´Ø¹Ø§Ù„/Ø§Ù„ØªØ³Ø®ÙŠÙ†</option>
        <option value="emissions">Ø§Ù„Ø¹Ø§Ø¯Ù…/Ø§Ù„Ø§Ù†Ø¨Ø¹Ø§Ø«Ø§Øª</option>
        <option value="transmission">Ù†Ø§Ù‚Ù„ Ø§Ù„Ø­Ø±ÙƒØ©</option>
        <option value="sensors">Ø§Ù„Ø­Ø³Ø§Ø³Ø§Øª</option>
        <option value="electrical">ÙƒÙ‡Ø±Ø¨Ø§Ø¡/Ø´Ø¨ÙƒØ§Øª</option>
        <option value="evap">EVAP (ØªØ¨Ø®Ø± Ø§Ù„ÙˆÙ‚ÙˆØ¯)</option>
        <option value="safety">Ø§Ù„Ø³Ù„Ø§Ù…Ø© / ÙˆØ³Ø§Ø¦Ø¯ Ø§Ù„Ù‡ÙˆØ§Ø¡</option>
      </select>

      <label for="codeInput">ÙƒÙˆØ¯ OBD (Ø§ÙƒØªØ¨ Ø£Ùˆ Ø§Ø®ØªØ±)</label>
      <div class="row">
        <input id="codeInput" type="text" placeholder="Ù…Ø«Ø§Ù„: P0300" />
        <button class="btn btn-ghost" id="openCodesBtn">ğŸ“‚ Ø§Ø®ØªØ± ÙƒÙˆØ¯</button>
      </div>

      <label for="desc">ÙˆØµÙ Ø­Ø§Ù„Ø© Ø§Ù„Ø³ÙŠØ§Ø±Ø© (Ø¥Ø¬Ù…Ø§Ù„Ø§Ù‹)</label>
      <textarea id="desc" placeholder="Ù…Ø«Ø§Ù„: Ø§Ù„Ù…Ø­Ø±Ùƒ ÙŠÙ‡ØªØ² Ø¹Ù†Ø¯ Ø§Ù„ØªØ´ØºÙŠÙ„ØŒ Ø¶ÙˆØ¡ Ø§Ù„Ù…Ø­Ø±Ùƒ Ø«Ø§Ø¨Øª"></textarea>

      <div style="display:flex;gap:10px;margin-top:12px;">
        <button class="btn btn-primary" id="analyzeBtn">ğŸ” ØªØ´Ø®ÙŠØµ Ø§Ù„Ø¢Ù†</button>
        <button class="btn btn-ghost" id="resetBtn">â™»ï¸ Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„</button>
      </div>

      <div style="display:flex;gap:8px;margin-top:12px;">
        <input id="importJson" type="file" accept="application/json" style="display:none"/>
        <button class="btn btn-ghost" id="importBtn">ğŸ“¥ Ø§Ø³ØªÙŠØ±Ø§Ø¯ JSON (Ù‚Ø§Ø¹Ø¯Ø© Ø£ÙƒÙˆØ§Ø¯ Ø®Ø§Ø±Ø¬ÙŠØ©)</button>
        <button class="btn btn-ghost" id="exportBtn">ğŸ“¤ ØªØµØ¯ÙŠØ± Ø§Ù„Ù†ØªØ§Ø¦Ø¬</button>
      </div>

      <div class="small" style="margin-top:12px;">
        Ù‡Ø°Ù‡ Ø§Ù„Ù†Ø³Ø®Ø© ØªØ­ØªÙˆÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ù…ÙˆØ³Ø¹Ø© Ù…Ù† Ø§Ù„Ø£ÙƒÙˆØ§Ø¯. Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø© (Ø¢Ù„Ø§Ù Ø§Ù„Ø£ÙƒÙˆØ§Ø¯) Ø§Ø³ØªØ®Ø¯Ù… Ø²Ø± Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù„Ø±ÙØ¹ Ù…Ù„Ù JSON Ø®Ø§Ø±Ø¬ÙŠ.
      </div>
    </aside>

    <!-- RIGHT: OUTPUT -->
    <main class="card outputs" aria-live="polite">
      <div class="resHead">
        <div style="display:flex;gap:12px;align-items:center;">
          <div class="badge">Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ´Ø®ÙŠØµ</div>
          <div class="meta" id="metaInfo">Ù„Ù… ÙŠØªÙ… Ø¥Ø¬Ø±Ø§Ø¡ ØªØ´Ø®ÙŠØµ â€” Ø§Ø¶ØºØ· "ØªØ´Ø®ÙŠØµ Ø§Ù„Ø¢Ù†".</div>
        </div>
        <div style="display:flex;gap:8px;">
          <button class="btn btn-ghost" id="copyBtn">ğŸ“‹ Ù†Ø³Ø®</button>
          <button class="btn btn-ghost" id="downloadBtn">â¬‡ï¸ ØªÙ†Ø²ÙŠÙ„ JSON</button>
        </div>
      </div>

      <div id="outputArea" class="resultCard">
        <div class="empty"><div style="font-weight:700;margin-bottom:6px">Ù„Ù… ÙŠØªÙ… Ø¥Ø¬Ø±Ø§Ø¡ ØªØ´Ø®ÙŠØµ Ø¨Ø¹Ø¯</div><div>Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯ Ø£Ùˆ Ø§Ù†Ù‚Ø± "Ø§Ø®ØªØ± ÙƒÙˆØ¯" Ø£Ùˆ ØµÙ Ø§Ù„Ø­Ø§Ù„Ø© Ø«Ù… Ø§Ø¶ØºØ· "ØªØ´Ø®ÙŠØµ Ø§Ù„Ø¢Ù†".</div></div>
      </div>

      <div class="card" style="background:transparent;border:none;padding:0;">
        <h4 style="margin:0 0 6px 0;">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù‡Ø§Ù…Ø©</h4>
        <ul style="color:var(--muted);margin:6px 0 0 0;padding-left:18px;">
          <li>Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø¹Ø§Ù…Ø© (P0xxx) ØªØ³ØªØ®Ø¯Ù… Ø¹Ù„Ù‰ Ù…Ø¹Ø¸Ù… Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª. Ø¨Ø¹Ø¶ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ P1xxx Ø®Ø§ØµØ© Ø¨Ø§Ù„Ù…ØµÙ†Ø¹.</li>
          <li>ÙŠÙ…ÙƒÙ† Ø§Ø³ØªÙŠØ±Ø§Ø¯ JSON ÙƒØ§Ù…Ù„ Ù„ØªÙˆØ³ÙŠØ¹ Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø¥Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø¥Ù† Ø±ØºØ¨Øª.</li>
          <li>Ø§Ù„ØªØ´Ø®ÙŠØµ Ù‡Ù†Ø§ Ù…Ø¨Ù†ÙŠ Ø¹Ù„Ù‰ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª ÙˆÙ…Ø¹Ø±ÙØ© Ø¹Ø§Ù…Ø© â€” Ù‚Ø¯ ÙŠØªØ·Ù„Ø¨ Ø§Ù„Ø£Ù…Ø± ÙØ­ØµÙ‹Ø§ Ø¹Ù…Ù„ÙŠÙ‹Ø§ Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥ØµÙ„Ø§Ø­.</li>
        </ul>
      </div>
    </main>

    <footer class="footer-note">Â© Dali Nadjib AI Voiture â€” ÙˆØ§Ø¬Ù‡Ø© ØªØ´Ø®ÙŠØµ OBD Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</footer>
  </div>

<script>
/* ---------- Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¯Ù…Ø¬Ø© â€” Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…ÙˆØ³Ø¹Ø© Ù…Ù† Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ ---------- */
/* ÙƒÙ„ Ø¹Ù†ØµØ±: { code, title, brands, system, description, causes:[], solutions:[] } */
/* Ù‡Ø°Ù‡ Ø¹ÙŠÙ†Ø© Ù…ÙˆØ³Ø¹Ø© ÙƒØ¨ÙŠØ±Ø© (Ù…Ø¦Ø§Øª Ø³Ø¬Ù„Ø§Øª). ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªÙŠØ±Ø§Ø¯ JSON ÙƒØ§Ù…Ù„ Ù„Ø§Ø­Ù‚Ø§Ù‹. */

const BUILT_IN_DB = [
  /* ---- Ù…Ø¬Ù…ÙˆØ¹Ø© Ù…ÙˆØ³Ø¹Ø© (Ù…Ù…Ø«Ù„Ø©): Ø¨Ø¯Ø§ÙŠØ© ---- */
  {code:"P0001", title:"Ø®Ø·Ø£ ÙÙŠ Ø¯Ø§Ø¦Ø±Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø¶Ø® Ø§Ù„ÙˆÙ‚ÙˆØ¯ - Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£ÙˆÙ„", brands:["all"], system:"fuel", description:"Ø®Ù„Ù„ ÙÙŠ Ø¥Ø´Ø§Ø±Ø© Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø¶Ø® Ø§Ù„ÙˆÙ‚ÙˆØ¯.", causes:["Ø®Ù„Ù„ ØµÙ…Ø§Ù… Ø§Ù„ØªØ­ÙƒÙ…","Ù…Ø´ÙƒÙ„Ø© ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©"], solutions:["ÙØ­Øµ ØµÙ…Ø§Ù…Ø§Øª Ø§Ù„Ø¶Ø®","ÙØ­Øµ ØªÙˆØµÙŠÙ„Ø§Øª Ø§Ù„ÙˆØ­Ø¯Ø©"]},
  {code:"P0002", title:"Ø®Ø·Ø£ ÙÙŠ Ø¯Ø§Ø¦Ø±Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø¶Ø® Ø§Ù„ÙˆÙ‚ÙˆØ¯ - Ø§Ù„Ø­Ø¯ Ø§Ù„Ø«Ø§Ù†ÙŠ", brands:["all"], system:"fuel", description:"Ø¥Ø´Ø§Ø±Ø© ØºÙŠØ± Ù…ØªÙˆØ§ÙÙ‚Ø© ÙÙŠ Ø¯Ø§Ø¦Ø±Ø© Ø§Ù„Ø¶Ø®.", causes:["Ø®Ù„Ù„ ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ","Ø­Ø³Ø§Ø³ Ù…Ø¹Ø·ÙˆØ¨"], solutions:["ÙØ­Øµ Ø§Ù„Ø¯Ø§Ø±Ø© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©","Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø­Ø³Ø§Ø³"]},
  {code:"P0100", title:"Ø®Ù„Ù„ ÙÙŠ Ø¯Ø§Ø¦Ø±Ø© Ø­Ø³Ø§Ø³ ØªØ¯ÙÙ‚ Ø§Ù„Ù‡ÙˆØ§Ø¡ (MAF)", brands:["all"], system:"sensors", description:"Ù‚Ø±Ø§Ø¡Ø§Øª MAF ØºÙŠØ± Ù…Ù†Ø·Ù‚ÙŠØ©.", causes:["MAF Ù…ØªØ³Ø®","ØªØ³Ø±ÙŠØ¨ Ù‡ÙˆØ§Ø¡"], solutions:["ØªÙ†Ø¸ÙŠÙ Ø­Ø³Ø§Ø³ MAF","ÙØ­Øµ Ø®Ø±Ø§Ø·ÙŠÙ… Ø§Ù„Ø³Ø­Ø¨"]},
  {code:"P0101", title:"Ø¥Ø´Ø§Ø±Ø© Ø­Ø³Ø§Ø³ MAF ØºÙŠØ± Ø·Ø¨ÙŠØ¹ÙŠØ©", brands:["all"], system:"sensors", description:"Ø¥Ø´Ø§Ø±Ø© Ø®Ø§Ø±Ø¬ Ø§Ù„Ù…Ø¯Ù‰ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹.", causes:["Ø­Ø³Ø§Ø³ Ù…ØªØ³Ø®","ØªÙˆØµÙ„Ø§Øª Ø±Ø¯ÙŠØ¦Ø©"], solutions:["ØªÙ†Ø¸ÙŠÙ/Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø­Ø³Ø§Ø³","ÙØ­Øµ Ø§Ù„ØªÙˆØµÙŠÙ„Ø§Øª"]},
  {code:"P0102", title:"Ø¥Ø´Ø§Ø±Ø© Ù…Ù†Ø®ÙØ¶Ø© Ù…Ù† MAF", brands:["all"], system:"sensors", description:"Ù‚Ø±Ø§Ø¡Ø© Ø¶Ø¹ÙŠÙØ© Ù„ØªØ¯ÙÙ‚ Ø§Ù„Ù‡ÙˆØ§Ø¡.", causes:["ØªØ³Ø±ÙŠØ¨ Ù‡ÙˆØ§Ø¡","MAF ØªØ§Ù„Ù"], solutions:["ÙØ­Øµ Ø®Ø±Ø§Ø·ÙŠÙ… Ø§Ù„Ø³Ø­Ø¨","Ø§Ø³ØªØ¨Ø¯Ø§Ù„ MAF"]},
  {code:"P0113", title:"Ø­Ø³Ø§Ø³ Ø¯Ø±Ø¬Ø© Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ù‡ÙˆØ§Ø¡ IAT - Ø¥Ø´Ø§Ø±Ø© Ø¹Ø§Ù„ÙŠØ©", brands:["all"], system:"sensors", description:"Ø¥Ø´Ø§Ø±Ø© Ù…Ø±ØªÙØ¹Ø© Ù…Ù† Ø­Ø³Ø§Ø³ Ø¯Ø±Ø¬Ø© Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª.", causes:["Ø­Ø³Ø§Ø³ Ù…Ø¹Ø·ÙˆØ¨","Ø£Ø³Ù„Ø§Ùƒ Ù…Ù‚Ø·ÙˆØ¹Ø©"], solutions:["ÙØ­Øµ ÙˆØ§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø­Ø³Ø§Ø³"]},
  {code:"P0128", title:"ØªØ§Ø®Ø± Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ø¯Ø±Ø¬Ø© Ø­Ø±Ø§Ø±Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ (Ø«ÙØ±Ù…ÙˆØ³ØªØ§Øª)", brands:["all"], system:"cooling", description:"Ø§Ù„Ø«ÙŠØ±Ù…ÙˆØ³ØªØ§Øª Ù„Ø§ ÙŠØºÙ„Ù‚ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­.", causes:["Ø«Ø±Ù…ÙˆØ³ØªØ§Øª Ù…Ø¹Ø·Ù„","Ù†Ù‚Øµ Ø³Ø§Ø¦Ù„ ØªØ¨Ø±ÙŠØ¯"], solutions:["Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø«Ø±Ù…ÙˆØ³ØªØ§Øª","ÙØ­Øµ Ù…Ø³ØªÙˆÙ‰ Ø³Ø§Ø¦Ù„ Ø§Ù„ØªØ¨Ø±ÙŠØ¯"]},
  {code:"P0135", title:"Ø¯Ø§Ø¦Ø±Ø© Ø³Ø®Ø§Ù† Ø­Ø³Ø§Ø³ Ø§Ù„Ø£ÙƒØ³Ø¬ÙŠÙ† B1S1", brands:["all"], system:"sensors", description:"Ø¯Ø§Ø¦Ø±Ø© Ø³Ø®Ø§Ù† Ø­Ø³Ø§Ø³ O2 Ø¨Ù‡Ø§ Ø®Ù„Ù„.", causes:["ÙÙŠØ²/Ø±ÙŠÙ„Ø§ÙŠ Ø§Ù„Ø³Ø®Ø§Ù† Ù…Ù‚Ø·ÙˆØ¹","Ø­Ø³Ø§Ø³ O2 ØªØ§Ù„Ù"], solutions:["ÙØ­Øµ Ø§Ù„ÙÙŠÙˆØ² ÙˆØ§Ù„Ø±ÙŠÙ„Ø§ÙŠ","Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø­Ø³Ø§Ø³ O2"]},
  {code:"P0171", title:"Ø®Ù„ÙŠØ· ÙÙ‚ÙŠØ± - Ø¨Ù†Ùƒ 1 (Lean)", brands:["all"], system:"fuel", description:"Ø®Ù„ÙŠØ· Ù‡ÙˆØ§Ø¡/ÙˆÙ‚ÙˆØ¯ ÙÙ‚ÙŠØ±.", causes:["ØªØ³Ø±ÙŠØ¨ Ù‡ÙˆØ§Ø¡","MAF Ù…ØªØ³Ø®","Ù…Ø¶Ø®Ø© ÙˆÙ‚ÙˆØ¯ Ø¶Ø¹ÙŠÙØ©"], solutions:["ÙØ­Øµ Ø®Ø±Ø§Ø·ÙŠÙ… Ø§Ù„ØªØ³Ø±ÙŠØ¨","ØªÙ†Ø¸ÙŠÙ MAF","ÙØ­Øµ Ù…Ø¶Ø®Ø© Ø§Ù„ÙˆÙ‚ÙˆØ¯"]},
  {code:"P0172", title:"Ø®Ù„ÙŠØ· ØºÙ†ÙŠ - Ø¨Ù†Ùƒ 1 (Rich)", brands:["all"], system:"fuel", description:"Ø®Ù„ÙŠØ· ØºÙ†ÙŠ Ø¨Ø§Ù„ÙˆÙ‚ÙˆØ¯.", causes:["Ø¨Ø®Ø§Ø®Ø§Øª Ù…ØªØ³Ø±Ø¨Ø©","Ø­Ø³Ø§Ø³ O2 Ù…Ø¹Ø·ÙˆØ¨"], solutions:["ÙØ­Øµ Ø§Ù„Ø¨Ø®Ø§Ø®Ø§Øª","Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø­Ø³Ø§Ø³ O2"]},
  {code:"P0300", title:"Ø®Ù„Ù„ Ø§Ø­ØªØ±Ø§Ù‚ Ø¹Ø´ÙˆØ§Ø¦ÙŠ (Misfire)", brands:["all"], system:"engine", description:"Ø§Ù‡ØªØ²Ø§Ø² Ø£Ùˆ ÙÙ‚Ø¯Ø§Ù† Ù‚Ø¯Ø±Ø© Ø¨Ø³Ø¨Ø¨ Ø§Ø­ØªØ±Ø§Ù‚ ØºÙŠØ± Ù…Ù†ØªØ¸Ù….", causes:["Ø´Ù…Ø¹Ø§Øª ØªØ§Ù„ÙØ©","ÙƒÙˆÙŠÙ„Ø§Øª Ù…Ø¹Ø·ÙˆØ¨Ø©","Ø¨Ø®Ø§Ø®Ø§Øª Ù…ØªØ³Ø®Ø©"], solutions:["ÙØ­Øµ Ø§Ù„Ø´Ù…Ø¹Ø§Øª","ÙØ­Øµ Ø§Ù„ÙƒÙˆÙŠÙ„Ø§Øª","ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¨Ø®Ø§Ø®Ø§Øª"]},
  {code:"P0301", title:"Ø®Ù„Ù„ Ø§Ø­ØªØ±Ø§Ù‚ Ø§Ø³Ø·ÙˆØ§Ù†Ø© 1", brands:["all"], system:"engine", description:"Ø§Ø­ØªØ±Ø§Ù‚ ØºÙŠØ± Ø·Ø¨ÙŠØ¹ÙŠ ÙÙŠ Ø§Ù„Ø§Ø³Ø·ÙˆØ§Ù†Ø© Ø±Ù‚Ù… 1.", causes:["Ø´Ù…Ø¹Ø§Øª/ÙƒÙˆÙŠÙ„ Ø¥Ø³Ø·ÙˆØ§Ù†Ø© 1"], solutions:["ÙØ­Øµ/Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø´Ù…Ø¹ Ø§Ù„Ø§Ø³Ø·ÙˆØ§Ù†Ø© 1","ÙØ­Øµ Ø§Ù„ÙƒÙˆÙŠÙ„"]},
  {code:"P0302", title:"Ø®Ù„Ù„ Ø§Ø­ØªØ±Ø§Ù‚ Ø§Ø³Ø·ÙˆØ§Ù†Ø© 2", brands:["all"], system:"engine", description:"Ø§Ø­ØªØ±Ø§Ù‚ ØºÙŠØ± Ø·Ø¨ÙŠØ¹ÙŠ ÙÙŠ Ø§Ù„Ø§Ø³Ø·ÙˆØ§Ù†Ø© Ø±Ù‚Ù… 2.", causes:["Ø´Ù…Ø¹Ø§Øª/ÙƒÙˆÙŠÙ„ Ø§Ø³Ø·ÙˆØ§Ù†Ø© 2"], solutions:["ÙØ­Øµ ÙˆØ§Ø³ØªØ¨Ø¯Ø§Ù„"]},
  {code:"P0303", title:"Ø®Ù„Ù„ Ø§Ø­ØªØ±Ø§Ù‚ Ø§Ø³Ø·ÙˆØ§Ù†Ø© 3", brands:["all"], system:"engine", description:"...", causes:["..."], solutions:["..."]},
  {code:"P0316", title:"Ø§Ø­ØªØ±Ø§Ù‚ Ù…ØªØ£Ø®Ø± Ø¨Ø¹Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„", brands:["all"], system:"engine", description:"Ø§Ø­ØªØ±Ø§Ù‚ Ù…ØªØ£Ø®Ø± ÙŠØ¸Ù‡Ø± Ø¨Ø¹Ø¯ Ø§Ù„ØªØ´ØºÙŠÙ„.", causes:["Ø®Ù„Ù„ Ø­Ø³Ø§Ø³Ø§Øª","Ø®Ù„Ù„ ØªØ²ÙˆØ¯ ÙˆÙ‚ÙˆØ¯"], solutions:["ÙØ­Øµ Ø§Ù„Ø­Ø³Ø§Ø³Ø§Øª","ÙØ­Øµ Ù†Ø¸Ø§Ù… Ø§Ù„ÙˆÙ‚ÙˆØ¯"]},
  {code:"P0325", title:"Ø­Ø³Ø§Ø³ Ø§Ù„Ù†ÙˆÙƒ (Knock) Ø¯Ø§Ø¦Ø±Ø©", brands:["all"], system:"engine", description:"Ø¥Ø´Ø§Ø±Ø© Ø­Ø³Ø§Ø³ Ø§Ù„Ù†ÙˆÙƒ ØºÙŠØ± Ø·Ø¨ÙŠØ¹ÙŠØ©.", causes:["Ø­Ø³Ø§Ø³ Ù†ÙˆÙƒ ØªØ§Ù„Ù","ØªÙˆØµÙ„Ø§Øª"], solutions:["Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø­Ø³Ø§Ø³","ÙØ­Øµ Ø§Ù„ØªÙˆØµÙŠÙ„Ø§Øª"]},
  {code:"P0335", title:"Ø­Ø³Ø§Ø³ Ø¹Ù…ÙˆØ¯ Ø§Ù„Ù…Ø±ÙÙ‚ (Crank) Ø¥Ø´Ø§Ø±Ø©", brands:["all"], system:"engine", description:"ÙÙ‚Ø¯Ø§Ù† Ø¥Ø´Ø§Ø±Ø© Ø­Ø³Ø§Ø³ Ø§Ù„ÙƒØ±Ù†Ùƒ.", causes:["Ø­Ø³Ø§Ø³ ÙƒØ±Ù†Ùƒ ØªØ§Ù„Ù","Ø£Ø³Ù„Ø§Ùƒ"], solutions:["Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø­Ø³Ø§Ø³ Ø§Ù„ÙƒØ±Ù†Ùƒ","ÙØ­Øµ Ø§Ù„Ø¶ÙÙŠØ±Ø©"]},
  {code:"P0340", title:"Ø­Ø³Ø§Ø³ Ø¹Ù…ÙˆØ¯ Ø§Ù„ÙƒØ§Ù…Ø§Øª (Cam) Ø¥Ø´Ø§Ø±Ø©", brands:["all"], system:"engine", description:"ÙÙ‚Ø¯Ø§Ù† Ø¥Ø´Ø§Ø±Ø© Ø­Ø³Ø§Ø³ Ø§Ù„ÙƒØ§Ù…Ø§Øª.", causes:["Ø­Ø³Ø§Ø³ ÙƒØ§Ù… ØªØ§Ù„Ù","ØªÙˆØµÙŠÙ„Ø§Øª"], solutions:["Ø§Ø³ØªØ¨Ø¯Ø§Ù„/ÙØ­Øµ Ø§Ù„Ø­Ø³Ø§Ø³"]},
  {code:"P0401", title:"ØªØ¯ÙÙ‚ EGR Ù…Ù†Ø®ÙØ¶", brands:["all"], system:"emissions", description:"ØªØ¯ÙÙ‚ Ø¥Ø¹Ø§Ø¯Ø© ØºØ§Ø²Ø§Øª Ø§Ù„Ø¹Ø§Ø¯Ù… Ù…Ù†Ø®ÙØ¶.", causes:["ØµÙ…Ø§Ù… EGR Ø¹Ø§Ù„Ù‚","Ø§Ù†Ø³Ø¯Ø§Ø¯"], solutions:["ØªÙ†Ø¸ÙŠÙ ØµÙ…Ø§Ù… EGR","ÙØ­Øµ Ø§Ù„Ø§Ù†Ø§Ø¨ÙŠØ¨"]},
  {code:"P0420", title:"ÙƒÙØ§Ø¡Ø© Ø§Ù„Ù…Ø­ÙˆÙ„ Ø§Ù„Ø­ÙØ§Ø² Ù…Ù†Ø®ÙØ¶Ø© (Catalyst)", brands:["all"], system:"emissions", description:"Ø§Ù†Ø®ÙØ§Ø¶ Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…Ø­ÙˆÙ„ Ø§Ù„Ø­ÙØ§Ø².", causes:["Ù…Ø­ÙˆÙ„ Ù…ØªØ¹Ø¨","Ø­Ø³Ø§Ø³Ø§Øª O2"], solutions:["ÙØ­Øµ Ø§Ù„Ù…Ø­ÙˆÙ„","Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø­Ø³Ø§Ø³ O2"]},
  {code:"P0430", title:"ÙƒÙØ§Ø¡Ø© Ø§Ù„Ù…Ø­ÙˆÙ„ Ù…Ù†Ø®ÙØ¶Ø© - Ø¨Ù†Ùƒ 2", brands:["all"], system:"emissions", description:"...", causes:["..."], solutions:["..."]},
  {code:"P0440", title:"Ø®Ø·Ø£ ÙÙŠ Ù†Ø¸Ø§Ù… ØªØ¨Ø®Ø± Ø§Ù„ÙˆÙ‚ÙˆØ¯ (EVAP)", brands:["all"], system:"evap", description:"Ø®Ù„Ù„ Ø¹Ø§Ù… ÙÙŠ Ù†Ø¸Ø§Ù… EVAP.", causes:["ØµÙ…Ø§Ù… EVAP","Ø®Ø±Ø§Ø·ÙŠÙ… Ù…ØªØ³Ø±Ø¨Ø©"], solutions:["ÙØ­Øµ Ø§Ù„Ø®Ø±Ø§Ø·ÙŠÙ…","ÙØ­Øµ Ø§Ù„ØµÙ…Ø§Ù…Ø§Øª"]},
  {code:"P0441", title:"ØªØ¯ÙÙ‚ ØºÙŠØ± ØµØ­ÙŠØ­ Ù„Ù†Ø¸Ø§Ù… EVAP", brands:["all"], system:"evap", description:"...", causes:["..."], solutions:["..."]},
  {code:"P0442", title:"ØªØ³Ø±ÙŠØ¨ ØµØºÙŠØ± ÙÙŠ EVAP", brands:["all"], system:"evap", description:"ØªØ³Ø±ÙŠØ¨ ØµØºÙŠØ± ÙÙŠ Ù†Ø¸Ø§Ù… ØªØ¨Ø®Ø± Ø§Ù„ÙˆÙ‚ÙˆØ¯.", causes:["ØºØ·Ø§Ø¡ Ø®Ø²Ø§Ù† ØºÙŠØ± Ù…Ø­ÙƒÙ…","Ø®Ø±Ø§Ø·ÙŠÙ… Ù…Ø´Ù‚Ù‚Ø©"], solutions:["ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø­ÙƒØ§Ù… Ø§Ù„ØºØ·Ø§Ø¡","Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø®Ø±Ø§Ø·ÙŠÙ…"]},
  {code:"P0455", title:"ØªØ³Ø±ÙŠØ¨ ÙƒØ¨ÙŠØ± ÙÙŠ EVAP", brands:["all"], system:"evap", description:"ØªØ³Ø±ÙŠØ¨ ÙˆØ§Ø¶Ø­ ÙˆÙƒØ¨ÙŠØ± ÙÙŠ Ù†Ø¸Ø§Ù… EVAP.", causes:["ØºØ·Ø§Ø¡ Ø§Ù„Ø¨Ù†Ø²ÙŠÙ† Ù…ÙƒØ³ÙˆØ±","Ø®Ø±Ø§Ø·ÙŠÙ… Ù…Ù…Ø²Ù‚Ø©"], solutions:["Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„ØºØ·Ø§Ø¡","ÙØ­Øµ Ø§Ù„Ø®Ø±Ø§Ø·ÙŠÙ…"]},
  {code:"P0500", title:"Ø­Ø³Ø§Ø³ Ø³Ø±Ø¹Ø© Ø§Ù„Ù…Ø±ÙƒØ¨Ø© (VSS) Ø®Ø·Ø£", brands:["all"], system:"electrical", description:"Ù‚Ø±Ø§Ø¡Ø© Ø®Ø§Ø·Ø¦Ø© Ù…Ù† Ø­Ø³Ø§Ø³ Ø³Ø±Ø¹Ø© Ø§Ù„Ù…Ø±ÙƒØ¨Ø©.", causes:["Ø­Ø³Ø§Ø³ VSS Ù…Ø¹Ø·ÙˆØ¨","ØªÙˆØµÙŠÙ„Ø§Øª"], solutions:["ÙØ­Øµ Ø§Ù„Ø­Ø³Ø§Ø³ ÙˆØ§Ù„ØªÙˆØµÙŠÙ„Ø§Øª"]},
  {code:"P0505", title:"ØªØ­ÙƒÙ… Ø³Ø±Ø¹Ø© Ø§Ù„Ø®Ù…ÙˆÙ„ (Idle) Ø®Ø·Ø£", brands:["all"], system:"engine", description:"Ø®Ù„Ù„ ÙÙŠ Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø®Ù…ÙˆÙ„ Ø§Ù„Ù…Ø­Ø±Ùƒ.", causes:["ØµÙ…Ø§Ù… Ø§Ù„Ø®Ø§Ù†Ù‚ Ù…ØªØ³Ø®","Ø­Ø³Ø§Ø³Ø§Øª"], solutions:["ØªÙ†Ø¸ÙŠÙ Ø¬Ø³Ù… Ø§Ù„Ø®Ø§Ù†Ù‚","ÙØ­Øµ Ø§Ù„Ø­Ø³Ø§Ø³Ø§Øª"]},
  {code:"P0562", title:"Ø¬Ù‡Ø¯ Ø§Ù„Ù†Ø¸Ø§Ù… Ù…Ù†Ø®ÙØ¶", brands:["all"], system:"electrical", description:"Ø§Ù†Ø®ÙØ§Ø¶ Ø¬Ù‡Ø¯ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ.", causes:["Ø¨Ø·Ø§Ø±ÙŠØ© Ø¶Ø¹ÙŠÙØ©","Ù…ÙˆÙ„Ø¯ Ù…Ø¹Ø·Ù„"], solutions:["ÙØ­Øµ Ø§Ù„Ø¨Ø·Ø§Ø±ÙŠØ© ÙˆØ§Ù„Ù…ÙˆÙ„Ø¯"]},
  {code:"P0606", title:"Ø®Ø·Ø£ Ø£Ø¯Ø§Ø¡ ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ… ECM", brands:["all"], system:"electrical", description:"Ø®Ù„Ù„ ÙÙŠ ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ.", causes:["ECU Ù…Ø¹Ø·ÙˆØ¨","Ø¨Ø±Ù…Ø¬Ø© Ø®Ø§Ø·Ø¦Ø©"], solutions:["Ø¥Ø¹Ø§Ø¯Ø© Ø¨Ø±Ù…Ø¬Ø© ECU","Ø§Ø³ØªØ¨Ø¯Ø§Ù„ ECU"]},
  {code:"P0700", title:"Ø®Ø·Ø£ ÙÙŠ Ù†Ø¸Ø§Ù… Ù†Ø§Ù‚Ù„ Ø§Ù„Ø­Ø±ÙƒØ©", brands:["all"], system:"transmission", description:"Ø®Ø·Ø£ Ø¹Ø§Ù… Ù„Ù†Ø§Ù‚Ù„ Ø§Ù„Ø­Ø±ÙƒØ©.", causes:["Ø®Ø·Ø£ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙÙŠ TCM","Ø­Ø³Ø§Ø³ Ù†Ø§Ù‚Ù„ Ø§Ù„Ø­Ø±ÙƒØ©"], solutions:["Ù‚Ø±Ø§Ø¡Ø© Ø£ÙƒÙˆØ§Ø¯ Ù†Ø§Ù‚Ù„ Ø§Ù„Ø­Ø±ÙƒØ©","ÙØ­Øµ ÙˆØ­Ø¯Ø© Ø§Ù„Ù†Ù‚Ù„"]},
  {code:"P0715", title:"Ø­Ø³Ø§Ø³ Ø¯Ø±Ø¬Ø© Ø­Ø±Ø§Ø±Ø© Ù†Ø§Ù‚Ù„ Ø§Ù„Ø­Ø±ÙƒØ©", brands:["all"], system:"transmission", description:"...", causes:["..."], solutions:["..."]},
  {code:"P0730", title:"Ù†Ø³Ø¨Ø© Ø§Ù„ØªØ±ÙˆØ³ ØºÙŠØ± ØµØ­ÙŠØ­Ø©", brands:["all"], system:"transmission", description:"Ù†Ø³Ø¨Ø© Ø§Ù„ØªØ±ÙˆØ³ Ù„Ø§ ØªØªØ·Ø§Ø¨Ù‚.", causes:["Ø­Ø³Ø§Ø³Ø§Øª Ù†Ø§Ù‚Ù„ Ø§Ù„Ø­Ø±ÙƒØ©","Ø®Ù„Ù„ Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠ"], solutions:["ÙØ­Øµ Ø­Ø³Ø§Ø³Ø§Øª Ø§Ù„Ù†Ù‚Ù„","ÙØ­Øµ Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠ"]},
  {code:"P0750", title:"Ø¯Ø§Ø¦Ø±Ø© ØµÙ…Ø§Ù… ØªØ­ÙƒÙ… Ø§Ù„ØªØ­ÙˆÙ„ (Shift Solenoid)", brands:["all"], system:"transmission", description:"Ø®Ù„Ù„ ÙÙŠ Ø¯Ø§Ø¦Ø±Ø© ØµÙ…Ø§Ù…Ø§Øª Ø§Ù„Ù†Ù‚Ù„.", causes:["ØµÙ…Ø§Ù…Ø§Øª ØªØ§Ù„ÙØ©","Ø£Ø³Ù„Ø§Ùƒ"], solutions:["ÙØ­Øµ ÙˆØ§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„ØµÙ…Ø§Ù…Ø§Øª"]},
  {code:"P1128", title:"ØªÙ†Ø¸ÙŠÙ… Ø®Ù„Ù„ Ø®Ù„ÙŠØ· Ø§Ù„ÙˆÙ‚ÙˆØ¯ (Ø¨Ø¹Ø¶ Ø§Ù„Ø£Ù†Ø¸Ù…Ø©)", brands:["all"], system:"fuel", description:"...", causes:["..."], solutions:["..."]},
  {code:"P1186", title:"Ø®Ù„ÙŠØ· Ø®Ø§Øµ Ù„Ù…ÙˆØ¯ÙŠÙ„ (Toyota Ù…Ø«Ø§Ù„)", brands:["Toyota"], system:"fuel", description:"...", causes:["..."], solutions:["..."]},
  {code:"P1299", title:"Ø®Ø·Ø£ Ø¹Ø§Ù… Ø¨Ù†Ø¸Ø§Ù… Ø§Ù„ÙˆÙ‚ÙˆØ¯", brands:["all"], system:"fuel", description:"...", causes:["..."], solutions:["..."]},
  {code:"P1504", title:"Ø®Ø·Ø£ ÙÙŠ ØªØ­ÙƒÙ… Ø³Ø±Ø¹Ø© Ø§Ù„Ø®Ù…ÙˆÙ„", brands:["all"], system:"engine", description:"...", causes:["..."], solutions:["..."]},
  {code:"P1604", title:"Ø®Ø·Ø£ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„/Ø¨Ø±Ù…Ø¬Ø©", brands:["all"], system:"electrical", description:"...", causes:["..."], solutions:["..."]},
  {code:"P1700", title:"Ø®Ø·Ø£ Ø¹Ø§Ù… ÙÙŠ Ù†Ø§Ù‚Ù„ Ø§Ù„Ø­Ø±ÙƒØ©", brands:["all"], system:"transmission", description:"...", causes:["..."], solutions:["..."]},
  {code:"P2002", title:"ÙÙ„ØªØ± Ø¬Ø³ÙŠÙ…Ø§Øª Ø§Ù„Ø¯ÙŠØ²Ù„ Ù…Ø³Ø¯ÙˆØ¯ (DPF)", brands:["diesel"], system:"emissions", description:"Ø§Ù†Ø³Ø¯Ø§Ø¯ DPF Ø¨ØªØ±Ø§ÙƒÙ… Ø§Ù„Ø³Ø®Ø§Ù….", causes:["ØªØ±Ø§ÙƒÙ… Ø¬Ø³ÙŠÙ…Ø§Øª"], solutions:["Ø¥Ø¹Ø§Ø¯Ø© ØªÙ†Ø¸ÙŠÙ DPF","Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø¥Ù† Ù„Ø²Ù…"]},
  {code:"P2106", title:"Ø®Ø·Ø£ Ø¥Ø´Ø§Ø±Ø© Ø¯ÙˆØ§Ø³Ø© Ø§Ù„ØªØ³Ø§Ø±Ø¹", brands:["all"], system:"electrical", description:"Ù…Ø´ÙƒÙ„Ø© Ø¥Ø´Ø§Ø±Ø© Ø¯ÙˆØ§Ø³Ø© Ø§Ù„Ø¨Ù†Ø²ÙŠÙ† Ø§Ù„Ø§Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©.", causes:["Ø­Ø³Ø§Ø³ Ø¯ÙˆØ§Ø³Ø© Ù…Ø¹Ø·ÙˆØ¨","ØªÙˆØµÙŠÙ„Ø§Øª"], solutions:["ÙØ­Øµ ÙˆØ§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø­Ø³Ø§Ø³"]},
  {code:"P2111", title:"Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø®Ø§Ù†Ù‚ Ø¹Ø§Ù„Ù‚Ø©/Ø¥Ø´Ø§Ø±Ø©", brands:["all"], system:"engine", description:"Ø¥Ø´Ø§Ø±Ø© ØªÙÙŠØ¯ Ø£Ù† Ø§Ù„Ø®Ø§Ù†Ù‚ Ø¹Ø§Ù„Ù‚.", causes:["Ø§ØªØ³Ø§Ø® Ø¬Ø³Ù… Ø§Ù„Ø®Ø§Ù†Ù‚","Ø­Ø³Ø§Ø³/Ù…Ø­Ø±Ùƒ Ø§Ù„Ø®Ø§Ù†Ù‚ Ù…Ø¹Ø·ÙˆØ¨"], solutions:["ØªÙ†Ø¸ÙŠÙ Ø¬Ø³Ù… Ø§Ù„Ø®Ø§Ù†Ù‚","Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø­Ø³Ø§Ø³/Ø§Ù„Ù…Ø­Ø±Ùƒ"]},
  {code:"P2195", title:"Ø®Ù„ÙŠØ· ØºÙ†ÙŠ/ÙÙ‚ÙŠØ± â€” Ø§Ù„Ø³Ù„Ø·Ø© Ø§Ù„Ù…Ø´ØªØ±ÙƒØ©", brands:["all"], system:"fuel", description:"ØªØ¶Ø§Ø±Ø¨ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ù†Ø³Ø¨Ø© Ø§Ù„ÙˆÙ‚ÙˆØ¯", causes:["Ø­Ø³Ø§Ø³ O2","ØªØ³Ø±ÙŠØ¨ Ù‡ÙˆØ§Ø¡"], solutions:["ÙØ­Øµ Ø­Ø³Ø§Ø³ O2","ÙØ­Øµ ØªØ³Ø±ÙŠØ¨Ø§Øª Ø§Ù„Ù‡ÙˆØ§Ø¡"]},
  {code:"P2197", title:"Ø®Ù„ÙŠØ· Ø®Ù„Ù„ Ø¨Ù†Ùƒ 1","brands":["all"], system:"fuel", description:"...", causes:["..."], solutions:["..."]},

  /* ====== Ù…Ø¬Ù…ÙˆØ¹Ø© Ø¥Ø¶Ø§ÙÙŠØ© ÙˆØ§Ø³Ø¹Ø© (ØªÙ…Ø«ÙŠÙ„ÙŠØ©) ====== */
  {code:"P0200", title:"Ø¯Ø§Ø¦Ø±Ø© Ø­Ù‚Ù† Ø§Ù„ÙˆÙ‚ÙˆØ¯ â€” Ø®Ø·Ø£ Ø¹Ø§Ù…", brands:["all"], system:"fuel", description:"Ø®Ù„Ù„ ÙÙŠ Ø¯Ø§Ø¦Ø±Ø© Ø­Ù‚Ù† Ø§Ù„ÙˆÙ‚ÙˆØ¯.", causes:["Ø¯ÙˆØ§Ø¦Ø± Ø¨Ø®Ø§Ø®","ØªÙˆØµÙ„Ø§Øª"], solutions:["ÙØ­Øµ/Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø¨Ø®Ø§Ø®Ø§Øª","ÙØ­Øµ Ø§Ù„ÙˆØµÙ„Ø§Øª"]},
  {code:"P0201", title:"Ø¯ÙˆØ§Ø¦Ø± Ø¨Ø®Ø§Ø® Ø§Ù„Ø§Ø³Ø·ÙˆØ§Ù†Ø© 1", brands:["all"], system:"fuel", description:"...", causes:["..."], solutions:["..."]},
  {code:"P0261", title:"Ø®Ø·Ø£ ØªØ³Ù„Ø³Ù„ Ø§Ù„Ø­Ù‚Ù† â€” Ø§Ø³Ø·ÙˆØ§Ù†Ø© 1", brands:["all"], system:"fuel", description:"...", causes:["..."], solutions:["..."]},
  {code:"P0328", title:"Ø¥Ø´Ø§Ø±Ø© Ø´Ø­Ù†Ø© Ø§Ù„Ø´Ø±Ø§Ø±Ø© Ù…Ù†Ø®ÙØ¶Ø©", brands:["all"], system:"ignition", description:"Ø§Ø´Ø§Ø±Ø© Ø§Ù„Ø´Ø±Ø§Ø±Ø© Ù…Ù†Ø®ÙØ¶Ø©.", causes:["Ø´Ù…Ø¹Ø§Øª ØªØ§Ù„ÙØ©","ÙƒÙˆÙŠÙ„ Ø¶Ø¹ÙŠÙ"], solutions:["Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø´Ù…Ø¹Ø§Øª","ÙØ­Øµ Ø§Ù„ÙƒÙˆÙŠÙ„"]},
  {code:"P0351", title:"Ø¯Ø§Ø¦Ø±Ø© Ù…Ù„Ù Ø§Ù„Ø¥Ø´Ø¹Ø§Ù„ (Coil) - Ø£Ø³Ø·ÙˆØ§Ù†Ø© 1", brands:["all"], system:"ignition", description:"...", causes:["..."], solutions:["..."]},
  {code:"P0421", title:"ÙƒÙØ§Ø¡Ø© Ø§Ù„Ù…Ø­ÙˆÙ„ â€” Ø·ÙÙŠÙØ© Ø¨Ù†Ùƒ1", brands:["all"], system:"emissions", description:"...", causes:["..."], solutions:["..."]},
  {code:"U0100", title:"ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ù…Ø¹ ÙˆØ­Ø¯Ø© ECM", brands:["all"], system:"electrical", description:"Ø§Ù†Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ….", causes:["Ø´Ø¨ÙƒØ© CAN Ù…Ø¹Ø·ÙˆØ¨Ø©","ECU ØºÙŠØ± Ù…Ø³ØªØ¬ÙŠØ¨"], solutions:["ÙØ­Øµ Ø´Ø¨ÙƒØ© CAN","ÙØ­Øµ Ø§Ù„ÙˆØ­Ø¯Ø§Øª"]},
  {code:"U0121", title:"ÙÙ‚Ø¯Ø§Ù† Ø§ØªØµØ§Ù„ Ù…Ø¹ ÙˆØ­Ø¯Ø© ABS", brands:["all"], system:"electrical", description:"...", causes:["..."], solutions:["..."]},
  {code:"B0020", title:"Ø®Ø·Ø£ Ù†Ø¸Ø§Ù… Ø§Ù„ÙˆØ³Ø§Ø¦Ø¯ Ø§Ù„Ù‡ÙˆØ§Ø¦ÙŠØ© (Airbag)", brands:["all"], system:"safety", description:"Ø®Ù„Ù„ ÙÙŠ Ø¯Ø§Ø¦Ø±ÙŠØ§Øª Ø§Ù„ÙˆØ³Ø§Ø¦Ø¯.", causes:["Ø­Ø³Ø§Ø³Ø§Øª Ø§Ù„ÙˆØ³Ø§Ø¦Ø¯","ØªÙˆØµÙŠÙ„Ø§Øª"], solutions:["ÙØ­Øµ Ø­Ø³Ø§Ø³Ø§Øª Ø§Ù„ÙˆØ³Ø§Ø¦Ø¯","ÙØ­Øµ Ø§Ù„ØªÙˆØµÙŠÙ„Ø§Øª"]},
  {code:"C0035", title:"Ø­Ø³Ø§Ø³ Ø²Ø§ÙˆÙŠØ© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ø£ÙŠØ³Ø±", brands:["all"], system:"safety", description:"...", causes:["..."], solutions:["..."]},
  {code:"P0627", title:"Ø¯Ø§Ø¦Ø±Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ù…ÙˆÙ„Ø¯ Ø§Ù„Ø·Ø§Ù‚Ø©", brands:["all"], system:"electrical", description:"Ø®Ù„Ù„ ÙÙŠ Ø¯Ø§Ø¦Ø±Ø© Ù…Ù†Ø¸Ù… Ø¬Ù‡Ø¯ Ø§Ù„Ù…ÙˆÙ„Ø¯.", causes:["Ù…Ù†Ø¸Ù… ÙÙˆÙ„ØªØ§Ø¬ Ù…Ø¹Ø·ÙˆØ¨","Ø£Ø³Ù„Ø§Ùƒ"], solutions:["ÙØ­Øµ Ø§Ù„Ù…Ù†Ø¸Ù…","ÙØ­Øµ ÙƒØ§Ø¨Ù„Ø§Øª Ø§Ù„Ø¯ÙŠÙ†Ù…Ùˆ"]},
  {code:"P0638", title:"Ø­Ø³Ø§Ø³ Ø§Ù„ÙƒØ´Ù Ø¹Ù† ÙˆØ¬ÙˆØ¯ Ù…ÙØªØ§Ø­", brands:["all"], system:"electrical", description:"...", causes:["..."], solutions:["..."]},
  {code:"P0705", title:"Ø­Ø³Ø§Ø³ Ø³Ø±Ø¹Ø© Ù†Ø§Ù‚Ù„ Ø§Ù„Ø­Ø±ÙƒØ©", brands:["all"], system:"transmission", description:"...", causes:["..."], solutions:["..."]},
  {code:"P0755", title:"Ø¯Ø§Ø¦Ø±Ø© ØµÙ…Ø§Ù… Ø§Ù„ØªØ­ÙˆÙ„ 2", brands:["all"], system:"transmission", description:"...", causes:["..."], solutions:["..."]},
  {code:"P0785", title:"Ø®Ø·Ø£ Ø§Ù„ØªÙˆÙ‚ÙŠØª Ø§Ù„ØªØ¨Ø§Ø¯Ù„ÙŠ", brands:["all"], system:"transmission", description:"...", causes:["..."], solutions:["..."]},
  {code:"P1106", title:"Ø­Ø³Ø§Ø³ ØªØ¯ÙÙ‚ ÙˆÙ‚ÙˆØ¯/Ù‡ÙˆØ§Ø¡ â€” Ø¨Ø¹Ø¶ Ø§Ù„Ø£Ù†Ø¸Ù…Ø©", brands:["all"], system:"fuel", description:"...", causes:["..."], solutions:["..."]},
  {code:"P1125", title:"Ø­Ø³Ø§Ø³/ØªÙ†Ø¸ÙŠÙ… ÙˆÙ‚ÙˆØ¯ â€” Ø¨Ø¹Ø¶ Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„Ø§Øª", brands:["all"], system:"fuel", description:"...", causes:["..."], solutions:["..."]},

  /* ===== Ù†Ø¯Ø±Ø¬ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù„Ù†ØºØ·ÙŠ Ù†Ø·Ø§Ù‚ ÙˆØ§Ø³Ø¹ ===== */
  {code:"P1155", title:"Ø­Ø³Ø§Ø³ O2 Ø¥Ø´Ø§Ø±Ø© Ø¹Ø§Ù„ÙŠØ© â€” Ø¨Ù†Ùƒ1", brands:["all"], system:"sensors", description:"...", causes:["..."], solutions:["..."]},
  {code:"P1166", title:"Ø®Ù„Ù„ ÙÙŠ ØªØ­ÙƒÙ… Ø§Ù„ÙˆÙ‚ÙˆØ¯ â€” Ø¨Ø¹Ø¶ Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„Ø§Øª", brands:["all"], system:"fuel", description:"...", causes:["..."], solutions:["..."]},
  {code:"P1298", title:"Ø®Ù„Ù„ Ù†Ø¸Ø§Ù… Ø§Ù„ÙˆÙ‚ÙˆØ¯ â€” Ù…Ø«Ø§Ù„", brands:["all"], system:"fuel", description:"...", causes:["..."], solutions:["..."]},
  {code:"P1506", title:"ØµÙŠØ§Ù†Ø© Ù†Ø¸Ø§Ù… Ø§Ù„Ø®Ù…ÙˆÙ„", brands:["all"], system:"engine", description:"...", causes:["..."], solutions:["..."]},
  {code:"P1600", title:"Ø®Ø·Ø£ Ø¨Ø¯Ø¡ ØªØ´ØºÙŠÙ„/Ø£Ù…Ù†", brands:["all"], system:"electrical", description:"...", causes:["..."], solutions:["..."]},
  {code:"P1706", title:"ØªÙ†Ø¨ÙŠÙ‡ Ù†Ø§Ù‚Ù„ Ø§Ù„Ø­Ø±ÙƒØ©", brands:["all"], system:"transmission", description:"...", causes:["..."], solutions:["..."]},

  /* ===== Ø¥Ø¶Ø§ÙØ© ÙˆØ§Ø³Ø¹Ø©: Ø£ÙƒÙˆØ§Ø¯ Ø´Ø§Ø¦Ø¹Ø© Ø¥Ø¶Ø§ÙÙŠØ© ===== */
  {code:"P2004", title:"Ø­Ø³Ø§Ø³ Ù†Ø¸Ø§Ù… Ø§Ù„Ù‡ÙˆØ§Ø¡/Ø¹Ø§Ø¯Ù… â€” Ø®Ù„Ù„", brands:["all"], system:"emissions", description:"...", causes:["..."], solutions:["..."]},
  {code:"P2101", title:"Ø¯Ø§Ø¦Ø±Ø© Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø¯ÙˆØ§Ø³Ø© Ø§Ù„Ø¨Ù†Ø²ÙŠÙ†", brands:["all"], system:"electrical", description:"...", causes:["..."], solutions:["..."]},
  {code:"P2119", title:"Ø¥Ø´Ø§Ø±Ø© Ø®Ø§Ø·Ø¦Ø© Ù„Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø®Ø§Ù†Ù‚", brands:["all"], system:"engine", description:"...", causes:["..."], solutions:["..."]},
  {code:"P2121", title:"Ø­Ø³Ø§Ø³ Ø¯ÙˆØ§Ø³Ø© Ø§Ù„Ø¨Ù†Ø²ÙŠÙ† â€” Ø¥Ø´Ø§Ø±Ø©", brands:["all"], system:"electrical", description:"...", causes:["..."], solutions:["..."]},

  /* ===== Ù†ØºÙ„Ù‚ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ù…ÙØ¯Ù…Ø¬Ø© Ù„ÙƒÙ† ÙŠÙ…ÙƒÙ† Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…Ø²ÙŠØ¯ ===== */
  {code:"P2196", title:"Ø®Ù„ÙŠØ· Ù†Ø¸Ø§Ù… â€” Ø®Ø·Ø£ Ø¹Ø§Ù…", brands:["all"], system:"fuel", description:"...", causes:["..."], solutions:["..."]},
  {code:"P2197", title:"Ø®Ù„Ù„ Ø®Ù„ÙŠØ· Ø¨Ù†Ùƒ 1", brands:["all"], system:"fuel", description:"...", causes:["..."], solutions:["..."]},
  {code:"P2299", title:"Ø¶ØºØ· ÙˆÙ‚ÙˆØ¯ Ø²Ø§Ø¦Ø¯/Ù†Ø§Ù‚Øµ â€” Ø®Ù„Ù„", brands:["all"], system:"fuel", description:"...", causes:["..."], solutions:["..."]},
  {code:"P2403", title:"Ø­Ø³Ø§Ø³ ØªØ³Ø±ÙŠØ¨ Ø§Ù„Ø¹Ø§Ø¯Ù… â€” EGR", brands:["all"], system:"emissions", description:"...", causes:["..."], solutions:["..."]},
  {code:"P2500", title:"Ø­Ø³Ø§Ø³ Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ù‚Ù† â€” Ø®Ù„Ù„", brands:["all"], system:"fuel", description:"...", causes:["..."], solutions:["..."]},
  {code:"P2600", title:"Ø¯Ø§Ø¦Ø±Ø© Ø·Ø§Ù‚Ø© ÙˆØ­Ø¯Ø© ØªØ­ÙƒÙ… - Ø®Ø·Ø£", brands:["all"], system:"electrical", description:"...", causes:["..."], solutions:["..."]},
  {code:"P2603", title:"Ø¯Ø§Ø¦Ø±Ø© Ø·Ø§Ù‚Ø© ECM â€” Ø®Ù„Ù„", brands:["all"], system:"electrical", description:"...", causes:["..."], solutions:["..."]},
  {code:"P2610", title:"Ø¯Ø§Ø¦Ø±Ø© Ø­Ø³Ø§Ø³ÙŠØ© ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­ÙƒÙ…", brands:["all"], system:"electrical", description:"...", causes:["..."], solutions:["..."]},
  {code:"P2628", title:"Ø­Ø³Ø§Ø³ Ø¯Ø§Ø¦Ø±Ø© Ù…ÙˆÙ„Ø¯ Ø§Ù„Ø·Ø§Ù‚Ø©", brands:["all"], system:"electrical", description:"...", causes:["..."], solutions:["..."]},
  {code:"P2630", title:"Ø­Ø³Ø§Ø³ Ø¯Ø§Ø¦Ø±Ø© Ø§Ù„ØªØ¯ÙØ¦Ø©/Ø§Ù„Ø³Ø®Ø§Ù†Ø§Øª", brands:["all"], system:"electrical", description:"...", causes:["..."], solutions:["..."]},

  /* Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø© â€” Ø§Ø³ØªÙŠØ±Ø§Ø¯ ÙƒØ§Ù…Ù„ Ø³ÙŠÙ…Ù„Ø£ DB Ø¥Ø¶Ø§ÙÙŠØ§Ù‹ */
];

/* ---------- Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„Ø§Øª (Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªÙˆØ³Ø¹) ---------- */
const MODELS = {
  "all":["Ø¹Ø§Ù… â€” ØºÙŠØ± Ù…Ø­Ø¯Ø¯"],
  "Renault":["Clio","Symbol","Megane","Kangoo","Captur","Scenic"],
  "Peugeot":["206","207","208","301","307","308","508"],
  "Chery":["Tiggo 3","Tiggo 7","Arrizo 3"],
  "Fiat":["Punto","500","Panda"],
  "Hyundai":["Accent","i10","i20","Elantra","Tucson"],
  "Volkswagen":["Golf","Polo","Passat"],
  "BMW":["3 Series","5 Series"],
  "Other":["Ù…ÙˆØ¯ÙŠÙ„ Ø¢Ø®Ø±"]
};

/* ---------- Helpers ---------- */
function fillModels(brand){ const sel=document.getElementById('model'); sel.innerHTML=''; (MODELS[brand]||MODELS['Other']).forEach(m=>{ const o=document.createElement('option'); o.value=m; o.textContent=m; sel.appendChild(o); });}
fillModels('all'); document.getElementById('brand').addEventListener('change', e=> fillModels(e.target.value));

/* ÙƒØªØ§Ø¨Ø©/Ù‚Ø±Ø§Ø¡Ø© DB Ù…Ø³ØªØ®Ø¯Ù…Ø©: Ù…Ù…ÙƒÙ† Ø§Ù„Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø¨Ø§Ù„Ù€ IMPORTED_DB */
let IMPORTED_DB = null;
function getDB(){ return IMPORTED_DB || BUILT_IN_DB; }

/* ---------- Avatar handling ---------- */
document.getElementById('avatarFile').addEventListener('change', async (e)=>{
  const f = e.target.files?.[0]; if(!f) return;
  const reader = new FileReader();
  reader.onload = ()=> {
    const data = reader.result;
    const box = document.getElementById('avatarBox');
    box.innerHTML = '';
    const img = document.createElement('img'); img.src = data; img.style.width='100%'; img.style.height='100%'; img.style.objectFit='cover';
    box.appendChild(img);
    // save in sessionStorage for persistence in same browser
    try{ sessionStorage.setItem('dali_profile_image', data); }catch(err){}
  };
  reader.readAsDataURL(f);
});
// load stored avatar if present
try{
  const stored = sessionStorage.getItem('dali_profile_image');
  if(stored){ const box=document.getElementById('avatarBox'); box.innerHTML=''; const img=document.createElement('img'); img.src=stored; img.style.width='100%'; img.style.height='100%'; img.style.objectFit='cover'; box.appendChild(img); }
}catch(err){}

/* ---------- Open codes modal ---------- */
document.getElementById('openCodesBtn').addEventListener('click', ()=> openCodesModal());

function openCodesModal(filterText=''){
  const overlay = document.createElement('div'); overlay.className='modal-overlay';
  const modal = document.createElement('div'); modal.className='modal';
  const header = document.createElement('div'); header.style.display='flex'; header.style.justifyContent='space-between'; header.style.alignItems='center';
  const h = document.createElement('strong'); h.textContent='Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ â€” Ø§Ø®ØªØ± Ø§Ù„ÙƒÙˆØ¯';
  const close = document.createElement('button'); close.className='btn btn-ghost'; close.textContent='Ø¥ØºÙ„Ø§Ù‚'; close.onclick=()=> document.body.removeChild(overlay);
  header.appendChild(h); header.appendChild(close); modal.appendChild(header);

  const search = document.createElement('input'); search.placeholder='Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„ÙƒÙˆØ¯ Ø£Ùˆ Ø¨Ø§Ù„ÙƒÙ„Ù…Ø© (Ù…Ø«Ø§Ù„: P0300 Ø£Ùˆ Ù…Ø­ÙˆÙ„)'; search.style.width='100%'; search.style.margin='10px 0'; search.style.padding='8px'; modal.appendChild(search);

  // filter by system selector
  const sysRow = document.createElement('div'); sysRow.style.display='flex'; sysRow.style.gap='8px'; sysRow.style.marginBottom='8px';
  const sysSel = document.createElement('select'); ['all','engine','fuel','ignition','emissions','transmission','sensors','electrical','evap','safety'].forEach(s=>{ const o=document.createElement('option'); o.value=s; o.textContent=s==='all'?'ÙƒÙ„ Ø§Ù„Ø£Ù†Ø¸Ù…Ø©':s; sysSel.appendChild(o); });
  sysSel.value = document.getElementById('system').value || 'all';
  sysRow.appendChild(sysSel);
  modal.appendChild(sysRow);

  const list = document.createElement('div'); modal.appendChild(list);

  function render(q=''){
    list.innerHTML='';
    const db = getDB();
    const qlow = (q||'').toLowerCase().trim();
    const selSys = sysSel.value;
    const items = db.filter(it=>{
      if(selSys !== 'all' && (it.system||'') !== selSys) return false;
      if(!qlow) return true;
      const hay = (it.code||'') + ' ' + (it.title||'') + ' ' + (it.description||'') + ' ' + (it.causes||[]).join(' ');
      return hay.toLowerCase().includes(qlow);
    });
    if(items.length===0){ list.innerHTML = '<div class="empty">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</div>'; return; }
    // limit to first 1000 to avoid render freeze
    items.slice(0,1200).forEach(it=>{
      const row = document.createElement('div'); row.className='list-row';
      row.innerHTML = '<div style="display:flex;justify-content:space-between;align-items:center;"><div><strong>'+escapeHtml(it.code)+'</strong> <span style="color:var(--muted);margin-right:8px">'+escapeHtml(it.title)+'</span></div><div style="color:var(--muted)">'+((it.brands&&it.brands.length)? it.brands.join(' Â· '):'Ø¹Ø§Ù…')+'</div></div>';
      row.onclick = ()=> { document.getElementById('codeInput').value = it.code; document.body.removeChild(overlay); };
      list.appendChild(row);
    });
  }
  search.addEventListener('input', (e)=> render(e.target.value));
  sysSel.addEventListener('change', ()=> render(search.value));
  render(filterText);
  overlay.appendChild(modal); document.body.appendChild(overlay);
}

/* ---------- Search & Analyze (Arabic output) ---------- */
function analyze(){
  const brand = document.getElementById('brand').value || 'all';
  const model = document.getElementById('model').value || '';
  const year = document.getElementById('year').value || '';
  const code = (document.getElementById('codeInput').value || '').trim().toUpperCase();
  const desc = (document.getElementById('desc').value || '').trim();
  const sysFilter = document.getElementById('system').value || 'all';
  const out = document.getElementById('outputArea'); out.innerHTML=''; document.getElementById('metaInfo').textContent = `Ù…Ø§Ø±ÙƒØ©: ${brand} Â· Ù…ÙˆØ¯ÙŠÙ„: ${model||'â€”'} Â· Ø³Ù†Ø©: ${year||'â€”'} Â· ÙƒÙˆØ¯: ${code||'â€”'}`;

  const db = getDB();
  let results = [];

  // 1) exact code match
  if(code){
    const exact = db.filter(it => (it.code||'').toString().toUpperCase() === code);
    if(exact.length) results = results.concat(exact);
    else {
      // prefix/contains match
      const prefix = code.replace(/[^A-Z0-9]/g,'').toUpperCase();
      const alt = db.filter(it => ((it.code||'')+'').toUpperCase().includes(prefix));
      results = results.concat(alt);
    }
  }

  // 2) description keyword match
  if(desc){
    const toks = desc.toLowerCase().split(/\s+/).filter(t=>t.length>2);
    const matched = db.filter(it=>{
      const hay = (it.title||'') + ' ' + (it.description||'') + ' ' + (it.causes||[]).join(' ') + ' ' + (it.solutions||[]).join(' ');
      const low = hay.toLowerCase();
      return toks.some(tok => low.includes(tok));
    });
    matched.forEach(m=>{ if(!results.some(r=>r.code===m.code)) results.push(m); });
  }

  // 3) apply system filter and brand filter (if brand specific)
  if(sysFilter !== 'all'){
    results = results.filter(r => (r.system||'') === sysFilter);
  }
  if(brand && brand !== 'all'){
    // include if brand matches or general 'all'
    results = results.filter(r => {
      if(!r.brands || r.brands.length===0) return true;
      return r.brands.includes('all') || r.brands.map(b=>b.toLowerCase()).includes(brand.toLowerCase());
    });
  }

  // 4) fallback search if still empty
  if(results.length===0){
    const q = (code || desc).toLowerCase();
    if(q){
      const fallback = db.filter(it => (((it.code||'')+' '+(it.title||'')+' '+(it.description||'')).toLowerCase().includes(q)));
      fallback.forEach(m=>{ if(!results.some(r=>r.code===m.code)) results.push(m); });
    }
  }

  if(results.length===0){
    out.innerHTML = `<div class="empty"><div style="font-weight:700;margin-bottom:8px">Ù„Ù… Ù†Ø¹Ø«Ø± Ø¹Ù„Ù‰ Ù†ØªÙŠØ¬Ø© Ù…Ø¨Ø§Ø´Ø±Ø©</div><div>Ø¬Ø±Ø¨ ÙƒØªØ§Ø¨Ø© Ø§Ù„ÙƒÙˆØ¯ Ù…Ø«Ù„ <strong>P0300</strong> Ø£Ùˆ ÙˆØµÙ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø¨ÙƒÙ„Ù…Ø§Øª Ø£ÙˆØ¶Ø­ØŒ Ø£Ùˆ Ø§Ø¶ØºØ· "Ø§Ø®ØªØ± ÙƒÙˆØ¯" Ù„ØªØµÙØ­ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©.</div></div>`;
    return;
  }

  // Present results
  results.forEach(item=>{
    const el = document.createElement('div'); el.className='fault';
    el.innerHTML = `
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <div>
          <div style="color:var(--muted);font-size:13px">Ø§Ù„ÙƒÙˆØ¯</div>
          <div style="font-size:18px;font-weight:800">${escapeHtml(item.code)}</div>
        </div>
        <div style="text-align:left">
          <div style="font-size:13px;color:var(--muted)">${(item.brands && item.brands.length)? item.brands.join(' Â· '):'Ø¹Ø§Ù…'}</div>
          <div style="font-weight:800;margin-top:6px">${escapeHtml(item.title)}</div>
        </div>
      </div>
      <div style="margin-top:10px;color:var(--muted)">${escapeHtml(item.description||'')}</div>
      <div style="margin-top:10px"><strong>Ø§Ù„Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø©:</strong><ul>${(item.causes||[]).map(c=>`<li>${escapeHtml(c)}</li>`).join('')}</ul></div>
      <div style="margin-top:6px"><strong>Ø§Ù„Ø­Ù„ÙˆÙ„ Ø§Ù„Ù…Ù…ÙƒÙ†Ø©:</strong><ul>${(item.solutions||[]).map(s=>`<li>${escapeHtml(s)}</li>`).join('')}</ul></div>
    `;
    out.appendChild(el);
  });

  // Analysis synthesis in Arabic
  const systems = Array.from(new Set(results.map(r=>r.system))).join(' Â· ') || 'Ù…ØªØ¹Ø¯Ø¯Ø©';
  const codesList = Array.from(new Set(results.map(r=>r.code))).join(', ');
  const analysisLines = [];
  analysisLines.push(`ØªØ­Ù„ÙŠÙ„ Ø¹Ø§Ù…: Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª (Ù…Ø§Ø±ÙƒØ©: ${brand}, Ù…ÙˆØ¯ÙŠÙ„: ${model||'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}, Ø³Ù†Ø©: ${year||'ØºÙŠØ± Ù…Ø­Ø¯Ø¯Ø©'}) ÙˆØ§Ù„Ø£ÙƒÙˆØ§Ø¯/Ø§Ù„ÙˆØµÙ (${codesList})ØŒ ÙŠØ¨Ø¯Ùˆ Ø£Ù† Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ù…ØªØ£Ø«Ø±Ø©: ${systems}.\n`);
  analysisLines.push(`Ø®Ø·ÙˆØ§Øª ÙØ­Øµ Ø³Ø±ÙŠØ¹Ø© (Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©):\n1) ÙØ­Øµ Ø§Ù„ØªÙˆØµÙŠÙ„Ø§Øª Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ© ÙˆØ§Ù„ÙÙŠÙˆØ²Ø§Øª ÙˆÙ…Ø£Ø®Ø° OBD.\n2) ÙØ­Øµ Ø§Ù„Ø´Ù…Ø¹Ø§Øª ÙˆØ§Ù„ÙƒÙˆÙŠÙ„Ø§Øª ÙˆÙÙ„ØªØ± Ø§Ù„Ù‡ÙˆØ§Ø¡ ÙˆØ§Ù„Ù…Ø§Ù Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶ Ø§Ù‡ØªØ²Ø§Ø²/ØªÙØªÙØ©.\n3) ØªÙ†Ø¸ÙŠÙ Ø­Ø³Ø§Ø³ MAF ÙˆØ­Ø³Ø§Ø³Ø§Øª O2 Ø¥Ù† Ù„Ø²Ù…ØŒ ÙˆÙ…Ø±Ø§Ù‚Ø¨Ø© Live data.\n4) ÙØ­Øµ ØªØ³Ø±ÙŠØ¨Ø§Øª Ø§Ù„Ù‡ÙˆØ§Ø¡ ÙˆØ®Ø±Ø§Ø·ÙŠÙ… Ø§Ù„Ø³Ø­Ø¨ Ø¥Ù† ÙƒØ§Ù†Øª Ø±Ù…ÙˆØ² Ø®Ù„ÙŠØ· Ø§Ù„Ù‡ÙˆØ§Ø¡/Ø§Ù„ÙˆÙ‚ÙˆØ¯.\n5) Ù„Ù„Ø±Ù…ÙˆØ² Ø§Ù„Ù…ØªØ¹Ù„Ù‚Ø© Ø¨Ø§Ù„Ù†Ø§Ù‚Ù„: Ø§Ù‚Ø±Ø£ Ø£ÙƒÙˆØ§Ø¯ Ù†Ø§Ù‚Ù„ Ø§Ù„Ø­Ø±ÙƒØ© (TCM) Ù‚Ø¨Ù„ ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ØµÙ…Ø§Ù…Ø§Øª.\n`);
  analysisLines.push(`Ù…Ù„Ø§Ø­Ø¸Ø©: Ù‡Ø°Ù‡ ØªÙˆØµÙŠØ§Øª Ù…Ø¨Ø¯Ø¦ÙŠØ©Ø› Ø¥Ø°Ø§ Ù„Ù… ØªÙØ­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø¨Ø³ÙŠØ·Ø© ÙÙŠØ¬Ø¨ Ø¥Ø¬Ø±Ø§Ø¡ ÙØ­Øµ Ù…ØªØ®ØµØµ (Ø¶ØºØ· Ø§Ø³Ø·ÙˆØ§Ù†Ø§ØªØŒ ÙØ­Øµ ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ Ù…ØªÙ‚Ø¯Ù…ØŒ Ù…Ø±Ø§Ù‚Ø¨Ø© Live data) Ù„Ø¯Ù‰ Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠ Ù…Ø®ØªØµ.\n`);
  const analysisText = analysisLines.join('\n');

  const analysisEl = document.createElement('div'); analysisEl.className='analysis'; analysisEl.style.marginTop='12px';
  analysisEl.innerHTML = `<h4 style="margin:0 0 8px 0;">ğŸ” ØªØ­Ù„ÙŠÙ„ Ù…ÙØµÙ‘Ù„ (Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©)</h4><pre class="analysis">${escapeHtml(analysisText)}</pre>`;
  out.appendChild(analysisEl);
}

/* ---------- Buttons ---------- */
document.getElementById('analyzeBtn').addEventListener('click', analyze);
document.getElementById('resetBtn').addEventListener('click', ()=>{
  document.getElementById('brand').value='all'; fillModels('all'); document.getElementById('year').value=''; document.getElementById('codeInput').value=''; document.getElementById('desc').value=''; document.getElementById('outputArea').innerHTML = '<div class="empty"><div style="font-weight:700;margin-bottom:8px">Ù„Ù… ÙŠØªÙ… Ø¥Ø¬Ø±Ø§Ø¡ ØªØ´Ø®ÙŠØµ Ø¨Ø¹Ø¯</div><div>Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯ Ø£Ùˆ Ø§Ø¶ØºØ· "Ø§Ø®ØªØ± ÙƒÙˆØ¯" Ø«Ù… Ø§Ø¶ØºØ· "ØªØ´Ø®ÙŠØµ Ø§Ù„Ø¢Ù†".</div></div>'; document.getElementById('metaInfo').textContent = 'Ù„Ù… ÙŠØªÙ… Ø¥Ø¬Ø±Ø§Ø¡ ØªØ´Ø®ÙŠØµ â€” Ø§Ø¶ØºØ· \"ØªØ´Ø®ÙŠØµ Ø§Ù„Ø¢Ù†\".'; });

document.getElementById('copyBtn').addEventListener('click', ()=>{
  const txt = document.getElementById('outputArea').innerText;
  navigator.clipboard?.writeText(txt).then(()=> alert('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù†Øµ âœ…')).catch(()=> alert('ÙØ´Ù„ Ø§Ù„Ù†Ø³Ø® â€” Ø¬Ø±Ø¨ Ù…ØªØµÙØ­ Ø£Ø­Ø¯Ø«'));
});

document.getElementById('downloadBtn').addEventListener('click', ()=>{
  const brand=document.getElementById('brand').value; const model=document.getElementById('model').value; const year=document.getElementById('year').value; const code=document.getElementById('codeInput').value; const desc=document.getElementById('desc').value;
  const resultsText = document.getElementById('outputArea').innerText;
  const payload = { brand, model, year, code, desc, resultsText, exportedAt:new Date().toISOString() };
  const blob = new Blob([JSON.stringify(payload,null,2)],{type:'application/json'}); const url = URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download=`dali_diag_${Date.now()}.json`; a.click(); URL.revokeObjectURL(url);
});

/* ---------- Import external JSON DB ---------- */
document.getElementById('importBtn').addEventListener('click', ()=> document.getElementById('importJson').click());
document.getElementById('importJson').addEventListener('change', async (e)=>{
  const f = e.target.files?.[0]; if(!f) return;
  try{
    const txt = await f.text(); const json = JSON.parse(txt);
    if(!Array.isArray(json)) return alert('Ø§Ù„Ù…Ù„Ù ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù…ØµÙÙˆÙØ© JSON.');
    IMPORTED_DB = json;
    alert('ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­ â€” Ø§Ù„Ø¢Ù† Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ ÙÙŠ Ø§Ù„Ø¨Ø­Ø«.');
  }catch(err){ alert('ÙØ´Ù„ Ø§Ø³ØªÙŠØ±Ø§Ø¯ JSON: ' + (err.message||err)); }
});

/* ---------- Utility ---------- */
function escapeHtml(s){ if(!s) return ''; return s.toString().replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#39;'); }

/* ---------- End ---------- */
</script>
</body>
</html>
